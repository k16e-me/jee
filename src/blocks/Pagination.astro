---
import { _sectionPadding } from '@scripts/snips'
import TitleHidden from './TitleHidden.astro'
import ButtonFab from '@atoms/ButtonFab.astro'

type Props = {
	total: number
	size: number
	current: number
	ariaLabel?: string
}

const { ariaLabel = 'Pagination', ...attrs } = Astro.props
const { total, size, current } = Astro.props,
	numberOfPages = Math.ceil(total / size)
const { pathname } = Astro.url
const baseUrl = pathname.replace(/\/$/, '')
console.log('Pathname: ' + pathname, 'BaseURL: ' + baseUrl)
---

{
	numberOfPages > 1 && (
		<nav
			aria-label={ariaLabel}
			{...attrs}
			class:list={['flex items-center w-full pt-8 sm:pt-10']}>
			<TitleHidden tag='h2' title={ariaLabel} />
			<ul class='flex items-center w-full gap-4'>
				{current > 1 && (
					<li>
						<a
							href={`${baseUrl}?page=${current - 1}`}
							aria-label={`Go to page ${current - 1} of ${numberOfPages}`}>
							<ButtonFab
								tag='span'
								size='large'
								style='brand'
								label={`Go to page ${current - 1} of ${numberOfPages}`}
								icon='arrow-left'
							/>
						</a>
					</li>
				)}

				<li>
					<ul class='flex items-center gap-4'>
						{Array(numberOfPages)
							.fill(0)
							.map((_, index) => (
								<li class='page'>
									<a
										href={`${baseUrl}?page=${index + 1}`}
										data-astro-prefetch
										aria-current={
											index + 1 === current
												? 'page'
												: undefined
										}
										class='flex h-10 w-10 items-center justify-center relative'>
										{index + 1}
									</a>
								</li>
							))}
					</ul>
				</li>

				{current < numberOfPages && (
					<li>
						<a
							href={`${baseUrl}?page=${current + 1}`}
							aria-label={`Go to page ${current + 1} of ${numberOfPages}`}>
							<ButtonFab
								tag='span'
								size='large'
								style='brand'
								label={`Go to page ${current + 1} of ${numberOfPages}`}
								icon='arrow-right'
							/>
						</a>
					</li>
				)}
			</ul>
		</nav>
	)
}

<style>
	.next:hover,
	.prev:hover {
		background: linear-gradient(
			247.23deg,
			rgba(74, 242, 200, 0.2) 0%,
			rgba(47, 76, 179, 0.2) 100%
		);
	}
	.page a[aria-current='page'] {
		background-color: rgba(0, 0, 0, 0.1);
		border-radius: 50%;
	}
</style>
