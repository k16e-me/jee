---
import { _sectionPadding } from '@scripts/snips'
import TitleHidden from './TitleHidden.astro'

type Props = {
	total: number
	size: number
	current: number
	ariaLabel?: string
}

const { ariaLabel = 'Pagination', ...attrs } = Astro.props
const { total, size, current } = Astro.props,
	numberOfPages = Math.ceil(total / size)
const { pathname } = Astro.url
// const baseUrl = pathname.replace(/\/$/, '')
const baseUrl = pathname
---

{
	numberOfPages > 1 && (
		<nav aria-label={ariaLabel} {...attrs} class:list={[_sectionPadding()]}>
			<TitleHidden tag='h2' title={ariaLabel} />
			<ul class='flex items-center gap-4'>
				{/* L.Arrow */}
				{current > 1 && (
					<li class='prev rounded-full border border-white'>
						<a
							href={`${baseUrl}?page=${current - 1}`}
							class='flex h-10 w-10 items-center justify-center'
							aria-label={`Go to page ${current - 1} of ${numberOfPages}`}>
							<svg
								xmlns='http://www.w3.org/2000/svg'
								width='32'
								height='32'
								viewBox='0 0 24 24'>
								<path
									fill='currentColor'
									d='m12 16l1.4-1.4l-1.6-1.6H16v-2h-4.2l1.6-1.6L12 8l-4 4zm0 6q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22'
								/>
							</svg>
						</a>
					</li>
				)}
				{/* Counts */}
				<li>
					<ul class='flex items-center gap-4'>
						{Array(numberOfPages)
							.fill(0)
							.map((_, index) => (
								<li class='page'>
									<a
										href={`${baseUrl}?page=${index + 1}`}
										data-astro-prefetch
										aria-current={
											index + 1 === current
												? 'page'
												: undefined
										}
										class='flex h-10 w-10 items-center justify-center relative'>
										{index + 1}
									</a>
								</li>
							))}
					</ul>
				</li>
				{/* R.Arrow */}
				{current < numberOfPages && (
					<li class='next rounded-full border border-white'>
						<a
							href={`${baseUrl}?page=${current + 1}`}
							class='flex h-10 w-10 items-center justify-center'
							aria-label={`Go to page ${current + 1} of ${numberOfPages}`}>
							<svg
								xmlns='http://www.w3.org/2000/svg'
								width='32'
								height='32'
								viewBox='0 0 24 24'>
								<path
									fill='currentColor'
									d='M12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m.2-9l-.9.9q-.275.275-.275.7t.275.7t.7.275t.7-.275l2.6-2.6q.3-.3.3-.7t-.3-.7l-2.6-2.6q-.275-.275-.7-.275t-.7.275t-.275.7t.275.7l.9.9H9q-.425 0-.712.288T8 12t.288.713T9 13z'
								/>
							</svg>
						</a>
					</li>
				)}
			</ul>
		</nav>
	)
}

<style>
	.next:hover,
	.prev:hover {
		background: linear-gradient(
			247.23deg,
			rgba(74, 242, 200, 0.2) 0%,
			rgba(47, 76, 179, 0.2) 100%
		);
	}
	.page a[aria-current='page'] {
		background-color: rgba(0, 0, 0, 0.1);
		border-radius: 50%;
	}
</style>
